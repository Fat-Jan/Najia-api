from typing import Tuple, Dict, List

# 十神
SHENX: Tuple[str, ...] = ('⽐肩', '劫财', '偏印', '正印', '偏官', '正官', '偏财', '正财', '⻝神', '伤官')

# 六神
SHEN6: Tuple[str, ...] = ('青龙', '朱雀', '勾陈', '螣蛇', '白虎', '玄武')

# 六亲
QING6: Tuple[str, ...] = ('兄弟', '父母', '官鬼', '妻财', '子孙')

# 五行
XING5: Tuple[str, ...] = ('木', '火', '土', '金', '水')

# 纳甲 - (内卦干支, 外卦干支)
NAJIA: Tuple[Tuple[str, str], ...] = (
    ('甲子寅辰', '壬午申戌'),
    ('丁巳卯丑', '丁亥酉未'),
    ('己卯丑亥', '己酉未巳'),
    ('庚子寅辰', '庚午申戌'),
    ('辛丑亥酉', '辛未巳卯'),
    ('戊寅辰午', '戊申戌子'),
    ('丙辰午申', '丙戌子寅'),
    ('乙未巳卯', '癸丑亥酉'),
)

# 八卦宫名
GONG8: str = '乾兑离震巽坎艮坤'

# 64卦字典 {卦符: 卦名}
GUA64: Dict[str, str] = {
    '111111': '乾为天', '011111': '天风姤', '001111': '天山遁', '000111': '天地否', '000011': '风地观', '000001': '山地剥',
    '000101': '火地晋', '111101': '火天大有', '110110': '兑为泽', '010110': '泽水困', '000110': '泽地萃', '001110': '泽山咸',
    '001010': '水山蹇', '001000': '地山谦', '001100': '雷山小过', '110100': '雷泽归妹', '101101': '离为火', '001101': '火山旅',
    '011101': '火风鼎', '010101': '火水未济', '010001': '山水蒙', '010011': '风水涣', '010111': '天水讼', '101111': '天火同人',
    '100100': '震为雷', '000100': '雷地豫', '010100': '雷水解', '011100': '雷风恒', '011000': '地风升', '011010': '水风井',
    '011110': '泽风大过', '100110': '泽雷随', '011011': '巽为风', '111011': '风天小畜', '101011': '风火家人', '100011': '风雷益',
    '100111': '天雷无妄', '100101': '火雷噬嗑', '100001': '山雷颐', '011001': '山风蛊', '010010': '坎为水', '110010': '水泽节',
    '100010': '水雷屯', '101010': '水火既济', '101110': '泽火革', '101100': '雷火丰', '101000': '地火明夷', '010000': '地水师',
    '001001': '艮为山', '101001': '山火贲', '111001': '山天大畜', '110001': '山泽损', '110101': '火泽睽', '110111': '天泽履',
    '110011': '风泽中孚', '001011': '风山渐', '000000': '坤为地', '100000': '地雷复', '110000': '地泽临', '111000': '地天泰',
    '111100': '雷天大壮', '111110': '泽天夬', '111010': '水天需', '000010': '水地比'
}

# 24节气
JIEQI = ('冬至', '小寒', '大寒', '立春', '雨水', '驚蟄', '春分', '清明', '穀雨', '立夏', '小滿',
         '芒種', '夏至', '小暑', '大暑', '立秋', '處暑', '白露', '秋分', '寒露', '霜降', '立冬',
         '小雪', '大雪')

# 卦名
GUAS = ('乾', '兑', '离', '震', '巽', '坎', '艮', '坤')

# 卦五行
GUA5 = (3, 3, 1, 0, 0, 4, 2, 2)

# 爻位
YAOS = ('111', '110', '101', '100', '011', '010', '001', '000')

# 天干
GANS = ('甲', '乙', '丙', '丁', '戊', '己', '庚', '辛', '壬', '癸')

# 地支
ZHIS = ('子', '丑', '寅', '卯', '辰', '巳', '午', '未', '申', '酉', '戌', '亥')

# 地支五行
ZHI5 = (4, 2, 0, 0, 2, 1, 1, 2, 3, 3, 2, 4)

# 旬空
KONG = ("子丑", "寅卯", "辰巳", "午未", "申酉", "戌亥")

# 农历月
MONS = ("冬", "腊", "正", "二", "三", "四", "五", "六", "七", "八", "九", "十")

# 农历日
DAYS = ("初一", "初二", "初三", "初四", "初五", "初六", "初七", "初八", "初九", "初十", "十一", "十二",
        "十三", "十四", "十五", "十六", "十七", "十八", "十九", "二十", "廿一", "廿二", "廿三", "廿四",
        "廿五", "廿六", "廿七", "廿八", "廿九", "三十", "卅一")

# 六冲卦
CHONG = ["乾", "兑", "离", "震", "巽", "坎", "艮", "坤", "大壮", "无妄"]

# 六合卦
LIUHE = ["否", "困", "旅", "豫", "节", "贲", "复", "泰"]

# 星期 周
WEEK = ("日", "一", "二", "三", "四", "五", "六")

# 显示卦标识
SYMBOL: List[List[str]] = [
    ["━", "━━━━", "━", "○→", "×→"],
    ["▅▅  ▅▅", "▅▅▅▅▅▅", "▅▅  ▅▅", "○→", "×→"],
    ["▅▅▅  ▅▅▅", "▅▅▅▅▅▅▅▅", "▅▅▅  ▅▅▅", "○→", "×→"]
]

# 优化：快速查找字典替代 O(n) 的 index() 操作
XING5_DICT: Dict[str, int] = {"木": 0, "火": 1, "土": 2, "金": 3, "水": 4}

# 天干快速查找字典（GANS.index() 替代）
GANS_DICT: Dict[str, int] = {char: idx for idx, char in enumerate(GANS)}

# 地支快速查找字典（ZHIS.index() 替代）
ZHIS_DICT: Dict[str, int] = {char: idx for idx, char in enumerate(ZHIS)}

# 八卦快速查找字典（YAOS.index() 替代）
YAOS_DICT: Dict[str, int] = {trigram: idx for idx, trigram in enumerate(YAOS)}

# 六亲矩阵（5×5 查找表）
# 元素索引: 0=木, 1=火, 2=土, 3=金, 4=水
QIN6_MATRIX: List[List[str]] = [
    ["兄弟", "子孙", "妻财", "官鬼", "父母"],  # 木
    ["父母", "兄弟", "子孙", "妻财", "官鬼"],  # 火
    ["官鬼", "父母", "兄弟", "子孙", "妻财"],  # 土
    ["妻财", "官鬼", "父母", "兄弟", "子孙"],  # 金
    ["子孙", "妻财", "官鬼", "父母", "兄弟"],  # 水
]

# 预计算所有64卦象的世应爻
# 结构: {卦符: (世爻, 应爻, 卦宫位置)}
SHIYING_PRECOMPUTED = {}

# 首先导入set_shi_yao函数，用于预计算
from .utils import set_shi_yao

for symbol in GUA64.keys():
    SHIYING_PRECOMPUTED[symbol] = set_shi_yao(symbol)

# 预计算所有64卦象的纳甲干支
# 结构: {卦符: [6个干支]}
NAJIA_PRECOMPUTED = {}

for symbol, name in GUA64.items():
    wai = symbol[3:]  # 外卦
    nei = symbol[:3]  # 内卦
    wai_idx, nei_idx = YAOS_DICT[wai], YAOS_DICT[nei]

    # 内卦
    gan_nei = NAJIA[nei_idx][0][0]
    zhi_nei = NAJIA[nei_idx][0][1:]
    najia_nei = [f'{gan_nei}{zhi}' for zhi in zhi_nei]

    # 外卦
    gan_wai = NAJIA[wai_idx][1][0]
    zhi_wai = NAJIA[wai_idx][1][1:]
    najia_wai = [f'{gan_wai}{zhi}' for zhi in zhi_wai]

    NAJIA_PRECOMPUTED[symbol] = najia_nei + najia_wai
